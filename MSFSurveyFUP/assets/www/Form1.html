<!DOCTYPE html>
<html>
<head>

<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
	
<title>MSF Form</title>
<link href="css/jquery.mobile-1.3.1.min.css" rel="stylesheet" type="text/css" />
<link href="css/msf_form.css" rel="stylesheet" type="text/css" />
	
<link href="css/mobiscroll.jqm.css" rel="stylesheet" type="text/css" />
<link href="css/mobiscroll.core.css" rel="stylesheet" type="text/css" />
	
<script src="js/lib/cordova-2.7.0.js" type="text/javascript"></script>
	
<script src="js/lib/jquery-1.8.2.js" type="text/javascript"></script>
<script src="js/lib/jquery.mobile-1.3.1.min.js" type="text/javascript"></script>

<script src="js/lib/mobiscroll.core.js" type="text/javascript"></script>
<script src="js/lib/mobiscroll.jqm.js" type="text/javascript"></script>
<script src="js/lib/mobiscroll.datetime.js" type="text/javascript"></script>
<script src="js/lib/i18n/mobiscroll.i18n.fr.js" type="text/javascript"></script>

<script src="js/lib/lodash.js" type="text/javascript"></script>
<script src="js/lib/backbone.js" type="text/javascript"></script>
<script src="js/lib/backbone.localStorage.js" type="text/javascript"></script>

<script src="js/mvc/form_defaults.js" type="text/javascript"></script>
<script src="js/mvc/form_views.js" type="text/javascript"></script>
<script src="js/mvc/page.js" type="text/javascript"></script>
<script src="js/mvc/form_model.js" type="text/javascript"></script>
<script src="js/mvc/obj_model.js" type="text/javascript"></script>
<script src="js/mvc/form_controller.js" type="text/javascript"></script>

<!-- <script src="js/test_init.js" type="text/javascript"></script> -->
<script src="js/Child_FUP.js" type="text/javascript"></script>

<script src="js/mvc/form_app.js" type="text/javascript"></script>


</head>

<body>
<script id='tmpl-page' type='text/template'>
	<div pageheader="true">
	</div>
	<div data-role="content">
	</div>
	<div data-role="footer"">
	</div>
</script>


<script id='tmpl-header' type='text/template'>
	<%= data.title %>
</script>

<script id='tmpl-footer' type='text/template'>
<div data-role="navbar" data-iconpos="<%= data.footerIconPosition %>">
	<ul>
		<li><a action="<%= data.footerButton1Action %>" data-icon="<%= data.footerButton1Icon %>" data-theme="<%= data.footerButton1Theme %>">
			<%= data.footerButton1Text %>
		</a></li>
		<li><a action="<%= data.footerButton2Action %>" data-icon="<%= data.footerButton2Icon %>" data-theme="<%= data.footerButton2Theme %>">
			<%= data.footerButton2Text %>
		</a></li>
		<li><a action="<%= data.footerButton3Action %>" data-icon="<%= data.footerButton3Icon %>" data-theme="<%= data.footerButton3Theme %>">
			<%= data.footerButton3Text %>
		</a></li>
	</ul>
</div>
</script>

<script id='tmpl-textview' type='text/template'>
<%
var inputId = data.view.id + '_input';
%>
<div class="textview" data-role="fieldcontain">
	<label for="<%= inputId %>"><%= data.model.get('label') %></label>
	<input type="text" id="<%= inputId %>" value="" />
</div>
</script>

<script id='tmpl-numberview' type='text/template'>
<%
var inputId = data.view.id + '_input';
%>
<div class="numberview" data-role="fieldcontain">
	<label for="<%= inputId %>"><%= data.model.get('label') %></label>
	<input type="number" id="<%= inputId %>" value="" />
</div>
</script>

<script id='tmpl-radioview' type='text/template'>
<%
var inputId = data.view.id + '-input';
%>
<div class="radioview" data-role="fieldcontain">
	<fieldset data-role="controlgroup">
		<legend><%= data.model.get('label') %></legend>
		<div>
		<% _.each(data.model.get('options'), function(option, index) {
			var currentId = inputId + '-' + index; %>
			<input type="radio" id="<%= currentId %>" name="<%= data.view.id %>" value="<%= option.value %>" />
			<label for="<%= currentId %>"><%= option.label %></label>
		<% }); %>
		</div>
	</fieldset>
</div>
</script>


<script id='tmpl-checkgroupview' type='text/template'>
<%
var inputId = data.view.id + '-input';
%>
<div class="checkgroupview" data-role="fieldcontain">
	<fieldset data-role="controlgroup">
		<legend><%= data.model.get('label') %></legend>
	</fieldset>
</div>
</script>

<script id='tmpl-checkview' type='text/template'>
	<input type="checkbox" id="<%= data.view.id %>" conceptId="<%= data.model.conceptId %>" />
	<label for="<%= data.view.id %>"><%= data.model.get('label') %></label>
</script>

<script id='tmpl-dateview' type='text/template'>
<%
var inputId = data.view.id + '_input';
%>
<div class="dateview" data-role="fieldcontain">
	<label for="<%= inputId %>"><%= data.model.get('label') %></label>
	<input type="text" id="<%= inputId %>" value=""/>
</div>
</script>

<script id='tmpl-submitpage' type='text/template'>
	<div class="ui-body ui-body-e" style="text-align:center;">
		<h2>Veuillez vérifier votre saisie</h2>
	</div>
	<ul data-role="listview" data-inset="true" data-divider-theme="d">
		<%
			for (var i = 0; i < PageService.pageModels.length; i++) {
				var pageModel = PageService.pageModels.at(i).attributes;
		%>
				<li data-role="list-divider"><%= pageModel.header.get('title') %></li>
				<% var addFields;
				addFields = function(viewModels) {
					for (var j = 0; j < viewModels.length; j++) { 
							var viewModel = viewModels[j];
							var conceptId = viewModel.conceptId;
							var itemLabel = viewModel.label;
							var children = viewModel.children;
							var value = ObsService.getObs(conceptId)
							if (value) {
							%>
								<li> <a href="#">
										<p><strong><%= itemLabel %></strong></p>
										<h2><%= value %></h2>
									</a> </li>
							<% }
							}

							if (children) {
								addFields(children);
							} %>
						<% } %>
					<% } %>
				<% addFields(pageModel.content.toJSON().views.toJSON()); %>
			<% } %>

	</ul>
</script>

<script id='tmpl-errormsg' type='text/template'>
	<div class="errorfield ui-body ui-body-e">
		<ul>
			<% for (var i = 0; i < data.errors.length; i++) { %>
				<li><%= data.errors[i] %></li>
			<% } %>
		</ul>
	</div>
</script>

<script id='tmpl-errorheader' type='text/template'>
	<div class="errorheader ui-body ui-body-e">
		<h2>Please fix errors before continuing</h2>
		<h3>There are <strong style="color : red"><%= data.errors.length %></strong> questions to fix.</h3>
	</div>
</script>

<div data-role="page" data-theme="c">
	<div data-role="header"></div>
	<div data-role="content"></div>
	<div data-role="footer"></div>
</div>

</body>

</html>